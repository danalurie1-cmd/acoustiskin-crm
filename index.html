<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Unified Customer Profile CRM</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #f7f9fc; }
        .crm-card { background: white; border-radius: 12px; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.1); }
        .section-header { cursor: pointer; transition: background-color 0.2s; }
        .section-header:hover { background-color: #f0f4f8; }
        .input-group label { font-size: 0.875rem; font-weight: 600; color: #4b5563; }
        .field-system { background-color: #e5e7eb; cursor: not-allowed; }
    </style>
</head>
<body>
    <div class="min-h-screen p-4 md:p-8">

        <!-- Header and Action Bar -->
        <header class="mb-6 flex justify-between items-center">
            <h1 class="text-3xl font-bold text-gray-800">Unified Customer Profile: Apex Solutions Corp</h1>
            <div class="space-x-3">
                <button id="archiveButton" class="bg-red-500 hover:bg-red-600 text-white font-semibold py-2 px-4 rounded-lg transition duration-150">
                    Deactivate / Archive
                </button>
                <button class="bg-indigo-600 hover:bg-indigo-700 text-white font-semibold py-2 px-4 rounded-lg transition duration-150">
                    Save Profile
                </button>
            </div>
        </header>
        
        <!-- Status Bar -->
        <div id="status-bar" class="w-full bg-blue-100 border border-blue-300 text-blue-800 p-3 rounded-lg mb-6 flex justify-between items-center transition-all duration-300">
             <p class="font-medium">Account Status: <span id="currentStatus" class="font-bold">Active Customer</span></p>
             <p class="text-sm">Last Updated: <span id="lastUpdated">N/A</span></p>
        </div>

        <form id="customerForm" class="space-y-6">

            <!-- Section X - Maintenance Features (Top-level actions) -->
            <div class="crm-card p-6 bg-yellow-50 border border-yellow-200">
                <h2 class="text-xl font-bold text-yellow-800 mb-4">Edit / Maintenance Features (System Control)</h2>
                <div class="flex flex-wrap gap-4">
                    <button type="button" class="bg-yellow-600 hover:bg-yellow-700 text-white font-semibold py-2 px-4 rounded-lg">
                        Add Additional Contact
                    </button>
                    <button type="button" class="bg-gray-200 hover:bg-gray-300 text-gray-800 font-semibold py-2 px-4 rounded-lg">
                        View Audit Trail
                    </button>
                    <div class="text-sm text-gray-600 self-center">
                        * Duplicate check runs on Save.
                    </div>
                </div>
            </div>

            <!-- CRM Profile Container - Two Columns on Desktop -->
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                
                <!-- COLUMN 1: Core Profile, Contacts, Attributes -->
                <div class="lg:col-span-2 space-y-6">
                    
                    <!-- Section I: Basic Company & Account Info -->
                    <div class="crm-card">
                        <div class="section-header p-4 border-b border-gray-100 flex justify-between items-center" onclick="toggleSection('basicInfo')">
                            <h2 class="text-lg font-semibold text-gray-700">I. Basic Company & Account Info</h2>
                            <span class="text-gray-500">&#9660;</span>
                        </div>
                        <div id="basicInfo" class="p-6 grid grid-cols-1 md:grid-cols-2 gap-4">
                            <!-- Customer Status -->
                            <div class="input-group">
                                <label for="customer_status">Customer Status</label>
                                <select id="customer_status" name="customer_status" class="w-full mt-1 p-2 border border-gray-300 rounded-md focus:ring-indigo-500 focus:border-indigo-500">
                                    <option value="Active Customer" selected>Active Customer</option>
                                    <option value="Prospect">Prospect</option>
                                    <option value="Inactive">Inactive</option>
                                    <option value="Archived">Archived</option>
                                </select>
                            </div>
                            <!-- Account / Customer ID -->
                            <div class="input-group">
                                <label for="account_id">Account / Customer ID</label>
                                <input type="text" id="account_id" value="CUST-900451" class="w-full mt-1 p-2 border field-system rounded-md" readonly>
                            </div>
                            <!-- Legal Company Name -->
                            <div class="input-group">
                                <label for="legal_name">Legal Company Name</label>
                                <input type="text" id="legal_name" value="Apex Solutions Corp" class="w-full mt-1 p-2 border border-gray-300 rounded-md">
                            </div>
                            <!-- DBA Name -->
                            <div class="input-group">
                                <label for="dba_name">Doing-Business-As (DBA) Name</label>
                                <input type="text" id="dba_name" placeholder="Leave blank if same" class="w-full mt-1 p-2 border border-gray-300 rounded-md">
                            </div>
                        </div>
                    </div>

                    <!-- Section III: Primary & Secondary Contacts -->
                    <div class="crm-card">
                        <div class="section-header p-4 border-b border-gray-100 flex justify-between items-center" onclick="toggleSection('contacts')">
                            <h2 class="text-lg font-semibold text-gray-700">III. Primary & Secondary Contacts</h2>
                            <span class="text-gray-500">&#9660;</span>
                        </div>
                        <div id="contacts" class="p-6 space-y-4">
                            <h3 class="font-bold text-base text-indigo-600 border-b pb-2">Primary Contact Person (Mandatory)</h3>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div class="input-group"><label>Name</label><input type="text" value="Jane Doe" class="w-full mt-1 p-2 border border-gray-300 rounded-md"></div>
                                <div class="input-group"><label>Job Title / Role</label><input type="text" value="Head of Procurement" class="w-full mt-1 p-2 border border-gray-300 rounded-md"></div>
                                <div class="input-group"><label>Phone number</label><input type="text" value="(555) 123-4567" class="w-full mt-1 p-2 border border-gray-300 rounded-md"></div>
                                <div class="input-group"><label>Email address</label><input type="email" value="jane.doe@apex.com" class="w-full mt-1 p-2 border border-gray-300 rounded-md"></div>
                            </div>
                            
                            <h3 class="font-bold text-base text-gray-600 border-b pb-2 mt-6">Secondary / Alternate Contact (Optional)</h3>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div class="input-group"><label>Name</label><input type="text" class="w-full mt-1 p-2 border border-gray-300 rounded-md"></div>
                                <div class="input-group"><label>Email</label><input type="email" class="w-full mt-1 p-2 border border-gray-300 rounded-md"></div>
                            </div>
                        </div>
                    </div>

                    <!-- Section IV: Company / Account Attributes -->
                    <div class="crm-card">
                        <div class="section-header p-4 border-b border-gray-100 flex justify-between items-center" onclick="toggleSection('attributes')">
                            <h2 class="text-lg font-semibold text-gray-700">IV. Company / Account Attributes</h2>
                            <span class="text-gray-500">&#9660;</span>
                        </div>
                        <div id="attributes" class="p-6 grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div class="input-group"><label>Industry / Business Type</label><select class="w-full mt-1 p-2 border border-gray-300 rounded-md"><option>Manufacturing</option></select></div>
                            <div class="input-group"><label>Company Size</label><select class="w-full mt-1 p-2 border border-gray-300 rounded-md"><option>51-200 employees</option></select></div>
                            <div class="input-group md:col-span-2"><label>Special handling instructions</label><textarea class="w-full mt-1 p-2 border border-gray-300 rounded-md">Requires Purchase Order (PO) for all purchases over $5,000.</textarea></div>
                        </div>
                    </div>
                </div>

                <!-- COLUMN 2: Order Info, Shipping, Billing -->
                <div class="lg:col-span-1 space-y-6">

                    <!-- Section V: Order & Transaction Info (Metrics) -->
                    <div class="crm-card">
                        <div class="section-header p-4 border-b border-gray-100 flex justify-between items-center" onclick="toggleSection('orders')">
                            <h2 class="text-lg font-semibold text-gray-700">V. Order & Transaction Info</h2>
                            <span class="text-gray-500">&#9660;</span>
                        </div>
                        <div id="orders" class="p-6 space-y-3">
                            <div class="input-group"><label>Total Lifetime Spend</label><input type="text" value="$2,450,000.00" class="w-full mt-1 p-2 border field-system rounded-md" readonly></div>
                            <div class="input-group"><label>Number of Orders Placed</label><input type="text" value="348" class="w-full mt-1 p-2 border field-system rounded-md" readonly></div>
                            <div class="input-group"><label>Last Order Date</label><input type="text" value="2025-10-20" class="w-full mt-1 p-2 border field-system rounded-md" readonly></div>
                            <div class="input-group"><label>Return Rate / Issues History</label><input type="text" value="1.2%" class="w-full mt-1 p-2 border field-system rounded-md" readonly></div>
                            <button type="button" class="w-full bg-indigo-100 text-indigo-700 font-medium py-2 rounded-md hover:bg-indigo-200 mt-2">
                                Order History Link (View 348 Past Orders)
                            </button>
                        </div>
                    </div>

                    <!-- Section VI: Shipping / Delivery Specifics -->
                    <div class="crm-card">
                        <div class="section-header p-4 border-b border-gray-100 flex justify-between items-center" onclick="toggleSection('shipping')">
                            <h2 class="text-lg font-semibold text-gray-700">VI. Shipping / Delivery Specifics</h2>
                            <span class="text-gray-500">&#9660;</span>
                        </div>
                        <div id="shipping" class="p-6 space-y-3">
                            <div class="input-group">
                                <label for="delivery_contact">Delivery Contact Name & Phone</label>
                                <input type="text" id="delivery_contact" value="Logistics Manager (ext 201)" class="w-full mt-1 p-2 border border-gray-300 rounded-md">
                            </div>
                            <div class="input-group">
                                <label for="delivery_instructions">Delivery Instructions / Access Notes</label>
                                <textarea id="delivery_instructions" class="w-full mt-1 p-2 border border-gray-300 rounded-md">Use loading dock #3. Deliveries accepted Mon-Fri, 9am-4pm ONLY.</textarea>
                            </div>
                            <div class="flex items-center space-x-2 mt-4">
                                <input type="checkbox" id="ship_account_provided" class="rounded text-indigo-600 focus:ring-indigo-500">
                                <label for="ship_account_provided" class="font-medium text-gray-700">Shipping Account Provided by Customer</label>
                            </div>
                            <div id="account_number_field" class="input-group hidden">
                                <label for="ship_account_num">Shipping Account Number</label>
                                <input type="text" id="ship_account_num" class="w-full mt-1 p-2 border border-gray-300 rounded-md">
                            </div>
                        </div>
                    </div>

                    <!-- Section VII: Billing & Payment Details -->
                    <div class="crm-card">
                        <div class="section-header p-4 border-b border-gray-100 flex justify-between items-center" onclick="toggleSection('billing')">
                            <h2 class="text-lg font-semibold text-gray-700">VII. Billing & Payment Details</h2>
                            <span class="text-gray-500">&#9660;</span>
                        </div>
                        <div id="billing" class="p-6 space-y-3">
                            <div class="input-group"><label>Payment Terms</label><select class="w-full mt-1 p-2 border border-gray-300 rounded-md"><option>Net 30</option></select></div>
                            <div class="input-group"><label>Credit Limit (If Applicable)</label><input type="text" value="$50,000.00" class="w-full mt-1 p-2 border border-gray-300 rounded-md"></div>
                            <div class="input-group"><label>Invoice Recipient Email</label><input type="email" value="invoices@apex.com" class="w-full mt-1 p-2 border border-gray-300 rounded-md"></div>
                        </div>
                    </div>

                    <!-- Section VIII: Compliance, Legal & Account Management -->
                    <div class="crm-card">
                        <div class="section-header p-4 border-b border-gray-100 flex justify-between items-center" onclick="toggleSection('compliance')">
                            <h2 class="text-lg font-semibold text-gray-700">VIII. Compliance, Legal & Account Management</h2>
                            <span class="text-gray-500">&#9660;</span>
                        </div>
                        <div id="compliance" class="p-6 space-y-3">
                            <div class="input-group"><label>Contract Start Date / End Date</label><input type="text" value="2024-01-01 / 2026-01-01" class="w-full mt-1 p-2 border border-gray-300 rounded-md"></div>
                            <div class="input-group"><label>Risk Rating</label><select class="w-full mt-1 p-2 border border-gray-300 rounded-md"><option>Low</option></select></div>
                            <div class="flex items-center space-x-2 mt-4">
                                <input type="checkbox" id="privacy_consent" checked class="rounded text-indigo-600 focus:ring-indigo-500">
                                <label for="privacy_consent" class="font-medium text-gray-700">Data Protection / Privacy Consent Captured</label>
                            </div>
                        </div>
                    </div>
                    
                </div>
            </div>

            <!-- Section II: Corporate Addresses (Full Width) -->
            <div class="crm-card">
                <div class="section-header p-4 border-b border-gray-100 flex justify-between items-center" onclick="toggleSection('addresses')">
                    <h2 class="text-lg font-semibold text-gray-700">II. Corporate & Primary Addresses</h2>
                    <span class="text-gray-500">&#9660;</span>
                </div>
                <div id="addresses" class="p-6 grid grid-cols-1 md:grid-cols-2 gap-6">
                    <!-- Corporate / Billing Address -->
                    <div>
                        <h3 class="font-bold text-base text-gray-800 mb-2">Corporate / Billing Address</h3>
                        <div class="input-group"><label>Street</label><input type="text" value="123 Main St" class="w-full mt-1 p-2 border border-gray-300 rounded-md"></div>
                        <div class="grid grid-cols-2 gap-4 mt-2">
                            <div class="input-group"><label>City</label><input type="text" value="Anytown" class="w-full mt-1 p-2 border border-gray-300 rounded-md"></div>
                            <div class="input-group"><label>State/Province</label><input type="text" value="CA" class="w-full mt-1 p-2 border border-gray-300 rounded-md"></div>
                        </div>
                        <div class="grid grid-cols-2 gap-4 mt-2">
                            <div class="input-group"><label>Postal/Zip Code</label><input type="text" value="90210" class="w-full mt-1 p-2 border border-gray-300 rounded-md"></div>
                            <div class="input-group"><label>Country</label><input type="text" value="United States" class="w-full mt-1 p-2 border border-gray-300 rounded-md"></div>
                        </div>
                    </div>
                    
                    <!-- Shipping Address -->
                    <div>
                        <div class="flex items-center justify-between mb-2">
                            <h3 class="font-bold text-base text-gray-800">Shipping Address</h3>
                            <div class="flex items-center">
                                <input type="checkbox" id="sameAsBilling" class="rounded text-indigo-600 focus:ring-indigo-500">
                                <label for="sameAsBilling" class="ml-2 text-sm text-gray-600 font-medium">Same as billing</label>
                            </div>
                        </div>
                        <div id="shippingAddressFields" class="space-y-2">
                            <div class="input-group"><label>Street</label><input type="text" value="123 Main St" class="w-full mt-1 p-2 border border-gray-300 rounded-md"></div>
                            <div class="grid grid-cols-2 gap-4">
                                <div class="input-group"><label>City</label><input type="text" value="Anytown" class="w-full mt-1 p-2 border border-gray-300 rounded-md"></div>
                                <div class="input-group"><label>State/Province</label><input type="text" value="CA" class="w-full mt-1 p-2 border border-gray-300 rounded-md"></div>
                            </div>
                            <div class="grid grid-cols-2 gap-4">
                                <div class="input-group"><label>Postal/Zip Code</label><input type="text" value="90210" class="w-full mt-1 p-2 border border-gray-300 rounded-md"></div>
                                <div class="input-group"><label>Country</label><input type="text" value="United States" class="w-full mt-1 p-2 border border-gray-300 rounded-md"></div>
                            </div>
                        </div>
                        <button type="button" class="mt-4 w-full bg-gray-100 text-gray-700 font-medium py-2 rounded-md hover:bg-gray-200">
                            Add Additional Shipping Address
                        </button>
                    </div>
                </div>
            </div>

            <!-- Section IX: Interaction & Support History (Timeline/Notes) -->
            <div class="crm-card">
                <div class="section-header p-4 border-b border-gray-100 flex justify-between items-center" onclick="toggleSection('history')">
                    <h2 class="text-lg font-semibold text-gray-700">IX. Interaction & Support History</h2>
                    <span class="text-gray-500">&#9660;</span>
                </div>
                <div id="history" class="p-6">
                    <h3 class="font-bold text-base text-gray-800 mb-3">Latest Activity</h3>
                    <ul class="space-y-4">
                        <li class="p-3 bg-indigo-50 border-l-4 border-indigo-500 rounded-md">
                            **Call Log:** Agent Alex updated Payment Terms to Net 30. (2025-11-01)
                        </li>
                        <li class="p-3 bg-red-50 border-l-4 border-red-500 rounded-md">
                            **Support Ticket #1004:** Issue with missing item in Order 998. (2025-10-25)
                        </li>
                        <li class="p-3 bg-green-50 border-l-4 border-green-500 rounded-md">
                            **Email:** Sent Order Confirmation for Order 1001. (2025-10-20)
                        </li>
                    </ul>
                    <div class="mt-6 input-group">
                        <label for="next_follow_up">Next Follow-Up Date</label>
                        <input type="date" id="next_follow_up" value="2025-11-20" class="w-full mt-1 p-2 border border-gray-300 rounded-md">
                    </div>
                </div>
            </div>
        </form>
    </div>

    <script>
        // --- Core Application Logic ---

        // 1. Toggle Section Functionality (Collapsible Accordions)
        function toggleSection(sectionId) {
            const section = document.getElementById(sectionId);
            if (section) {
                section.classList.toggle('hidden');
                // Optional: Update the arrow icon (if implemented)
            }
        }

        // 2. "Same as Billing" Checkbox Logic
        const sameAsBilling = document.getElementById('sameAsBilling');
        const shippingAddressFields = document.getElementById('shippingAddressFields');

        function updateShippingFields() {
            if (sameAsBilling.checked) {
                // If checked, disable fields and copy billing data (simulated)
                shippingAddressFields.querySelectorAll('input').forEach(input => {
                    input.setAttribute('readonly', 'true');
                    input.classList.add('field-system');
                });
            } else {
                // If unchecked, enable fields for custom input
                shippingAddressFields.querySelectorAll('input').forEach(input => {
                    input.removeAttribute('readonly');
                    input.classList.remove('field-system');
                });
            }
        }
        sameAsBilling.addEventListener('change', updateShippingFields);
        updateShippingFields(); // Run on load

        // 3. Customer Status Update Logic
        const customerStatus = document.getElementById('customer_status');
        const currentStatus = document.getElementById('currentStatus');
        const statusBar = document.getElementById('status-bar');

        customerStatus.addEventListener('change', (event) => {
            const status = event.target.value;
            currentStatus.textContent = status;

            // Update status bar color based on status (simulated onSnapshot feature)
            statusBar.classList.remove('bg-blue-100', 'bg-green-100', 'bg-yellow-100', 'bg-red-100');
            statusBar.classList.remove('border-blue-300', 'border-green-300', 'border-yellow-300', 'border-red-300');
            statusBar.classList.remove('text-blue-800', 'text-green-800', 'text-yellow-800', 'text-red-800');

            if (status === 'Active Customer') {
                statusBar.classList.add('bg-green-100', 'border-green-300', 'text-green-800');
            } else if (status === 'Prospect') {
                statusBar.classList.add('bg-blue-100', 'border-blue-300', 'text-blue-800');
            } else if (status === 'Inactive') {
                statusBar.classList.add('bg-yellow-100', 'border-yellow-300', 'text-yellow-800');
            } else if (status === 'Archived') {
                statusBar.classList.add('bg-red-100', 'border-red-300', 'text-red-800');
            }
        });

        // 4. Shipping Account Toggling Logic
        const shipAccountProvided = document.getElementById('ship_account_provided');
        const accountNumberField = document.getElementById('account_number_field');

        shipAccountProvided.addEventListener('change', () => {
            accountNumberField.classList.toggle('hidden', !shipAccountProvided.checked);
        });

        // 5. Deactivate/Archive Button Logic (Simulated)
        document.getElementById('archiveButton').addEventListener('click', () => {
            const archiveConfirmation = document.createElement('div');
            archiveConfirmation.innerHTML = `
                <div class="fixed inset-0 bg-gray-600 bg-opacity-75 flex items-center justify-center z-50">
                    <div class="bg-white p-8 rounded-xl shadow-2xl max-w-sm">
                        <h3 class="text-xl font-bold text-red-700 mb-4">Confirm Archive</h3>
                        <p class="text-gray-700 mb-6">Are you sure you want to deactivate Apex Solutions Corp? This will set the Customer Status to 'Archived'.</p>
                        <div class="flex justify-end space-x-3">
                            <button id="cancelArchive" class="px-4 py-2 text-gray-600 border border-gray-300 rounded-lg hover:bg-gray-100">Cancel</button>
                            <button id="confirmArchive" class="px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700">Confirm Deactivation</button>
                        </div>
                    </div>
                </div>
            `;
            document.body.appendChild(archiveConfirmation);

            document.getElementById('cancelArchive').addEventListener('click', () => {
                archiveConfirmation.remove();
            });

            document.getElementById('confirmArchive').addEventListener('click', () => {
                customerStatus.value = 'Archived';
                customerStatus.dispatchEvent(new Event('change')); // Trigger status update
                archiveConfirmation.remove();
            });
        });

        // 6. Set initial state (all sections collapsed by default except I, II, III)
        window.onload = () => {
            document.getElementById('lastUpdated').textContent = new Date().toLocaleDateString();
            
            // Hide all sections initially
            const allSections = ['basicInfo', 'contacts', 'attributes', 'orders', 'shipping', 'billing', 'compliance', 'history', 'addresses'];
            allSections.forEach(id => {
                 const section = document.getElementById(id);
                 if (section) section.classList.add('hidden');
            });
            
            // Explicitly show the most critical sections on load for UX
            document.getElementById('basicInfo').classList.remove('hidden');
            document.getElementById('contacts').classList.remove('hidden');
            document.getElementById('addresses').classList.remove('hidden');
        };
    </script>
</body>
</html>
